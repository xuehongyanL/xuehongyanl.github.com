---
layout: post
tags: ELOinFootball
---

![FIFA排名](/images/00021.jpg)

<!--more-->

（图文无关哈。。FIFA排名用的可不是ELO系统）

从这期开始我要开始正式测试了。理论部分还没完成，不过暂时还用不到那些部分。从此我们将踏入足球数据的大门（误）！

好了开始吧。

## 先浪费一个标题说明ELO系统在足球数据中的适用性

其实真没什么好说的。。显然。这标题果然是浪费了

## ELO系统的构造

为了省去一系列麻烦，我把初始分取1500，K值取32，e^(D/γ)取10^(D/400)（参见 **Elo系统及扩展（一）** 中的说明）

我将所有球队的初始积分设1500，每场比赛主胜赛果为1，平局为0.5，客胜为0。

我将以赛季为自变量，ELO分数值为因变量。每个赛季区间（长度为一年）按每支队伍的比赛场数等分。

至于历史上的赛制信息，可以参见我之前写的（**数据视角下的德国足球（一）联赛体系**）

## 数据

我的比赛赛果数据来自[德国**转会市场**网站](https://www.transfermarkt.co.uk/)的数据，但为了方便整合，我使用了英文版，也就是**.co.uk**的网站，球队名等也尽量为英语（当然还是有一些德语字母）

原始数据看起来是这样的：

![原始数据](/images/00022.jpg)

我也只提取了五个字段：**日期**，**时间**，**主队**，**比分**，**客队**。看起来有些少。。不过已经足够生成一个ELO系统了。况且早期的数据也就只能有这些了。。

数据包括了德甲德乙德丙，没有包括地区联赛，**数据截止到16-17赛季结束**。

我也按照 **联赛**（文件夹）-**赛季**（json文件）-**轮次**（列表）-**比赛**（子列表）-**数据**（孙子列表） 的结构组织了这些数据。需要注意的是我将早期的德乙联赛的南北区合并为一个文件，某一赛季出现了南北区轮数不一样的情况，导致了后几轮比赛数与前面几轮不同，不过对于研究没有大碍。

## ELO系统的实现

实现过程很简单，按照赛季顺序和轮次顺序为每场比赛计算ELO的变化就可以了。也不需要复杂的数据结构，规模来看也暂时不需要优化速度。

我用matplotlab绘制的图线如下（由于球队太多了，我将按16-17赛季的德甲德乙德丙球队分为三张）：

![德甲ELO](/images/00023.jpg)

![德乙ELO](/images/00024.jpg)

![德丙ELO](/images/00025.jpg)

（图像中有一些水平横线，这是由于那个球队在那个赛季没有参与统计中的联赛）


壮观吧。。

## 对于ELO联赛系统收敛速度的研究

由ELO系统的特点可知，一个ELO系统需要一些时间的对局来迭代和收敛。只有在充分收敛之后，一个球队的ELO积分才会接近其表现分的均值。

我想知道的是这个德国的联赛系统需要多长时间才能收敛？从哪个赛季起积分才是充分收敛的？数据最晚从哪个赛季开始使用，就可以保证获得一个收敛完全的ELO系统以供新赛季使用？

接下来就要靠试验了。。

我将枚举数据的起始年份和终止年份，分别按年份作出不同初始年份导致的最终积分的变化。

就以多特蒙德和拜仁慕尼黑两支队伍为例，其结果如下：

![ELO收敛1](/images/00026.jpg)

不妨换一种展示方式，自变量为起始赛季，因变量为以当年开始计算所得到的最终ELO积分与从1963年开始计算得到的最终ELO积分的差值的绝对值。所有球队图像整合如下：

![ELO收敛2](/images/00027.jpg)

我们看到，图象在1974年有一个拐点，可能是1974年德乙的设立所致。74-75赛季以前的数据大概吧。。就可以暂时不考虑了（当然数据是不能随便舍弃的。。）

进一步地，如果改变终止年份，当中止年份足够早的时候，这个拐点就不会出现了，可以肯定的是，在这个年份以后的赛季，ELO系统都是充分收敛的。我将在以后的章节中对此加以研究。

## 三级联赛的水平变化

由ELO子系统的知识可知，可以把每个联赛打包成一个新的元素从而形成一个新的ELO系统。（参见**Elo系统及扩展（一）**）

因此我们不妨把德甲德乙德丙联赛分别打包成一个实体，实体中的球队每个赛季不尽相同，但是它的一个重要属性——ELO平均值是可以动态变化的，代表了联赛间的相互水平。

把三个联赛的平均ELO作出图象，它看起来是这样的：

![三联赛水平变化](/images/00028.jpg)

不过由于德乙和德丙的收敛还不充分，现在还不能断定联赛间的实力差距变化，我或许会尝试一下使用德国杯的数据来辅助分析。

---

接下来我还将考虑一下足球场上的另一个因素——主场优势。我并不想用一个固定值表示主场优势，我准备将主场优势量化为一个ELO系统。

总之咱们下期接着来。

---

假如这篇有人看的话，谢谢阅读哦。

比心.

![比心](/images/bixin.jpg)
